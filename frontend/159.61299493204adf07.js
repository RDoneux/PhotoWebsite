"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[159],{6652:(b,c,r)=>{r.r(c),r.d(c,{ImageManagerModule:()=>h});var s=r(6895),p=r(6773),e=r(8256),C=r(5861),M=r(529),v=r(1588),O=r(2043),P=r(1195);class u{constructor(){this.fileDropped=new e.vpe,this.background="#ffffff"}dragOver(t){t.preventDefault(),t.stopPropagation(),this.background="#e2eefd"}dragLeave(t){t.preventDefault(),t.stopPropagation(),this.background="#ffffff"}drop(t){t.preventDefault(),t.stopPropagation(),this.background="#ffffff",this.fileDropped.emit(t)}static#e=this.\u0275fac=function(n){return new(n||u)};static#n=this.\u0275dir=e.lG2({type:u,selectors:[["","appDragDropFileUpload",""]],hostVars:2,hostBindings:function(n,o){1&n&&e.NdJ("dragover",function(l){return o.dragOver(l)})("dragleave",function(l){return o.dragLeave(l)})("drop",function(l){return o.drop(l)}),2&n&&e.Udp("background-color",o.background)},outputs:{fileDropped:"fileDropped"}})}class d{constructor(){}convertBytesToMegaBytes(t){for(var n=new Array("Bytes","KB","MB","GB"),o=0;t>900;)t/=1024,o++;return Math.round(100*t)/100+" "+n[o]}static#e=this.\u0275fac=function(n){return new(n||d)};static#n=this.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}var y=r(6054);function U(a,t){1&a&&e._UZ(0,"app-loading-spinner",8)}function T(a,t){1&a&&(e.TgZ(0,"span",9),e._uU(1," task_alt "),e.qZA())}const F=function(a,t){return{show:a,uploading:t}},x=function(a){return{show:a}};function Z(a,t){if(1&a){const n=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"p",3),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.removed())}),e._uU(3,"x"),e.qZA()(),e.TgZ(4,"img",4),e.NdJ("load",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.loading=!1)}),e.qZA(),e.YNc(5,U,1,0,"app-loading-spinner",5),e.YNc(6,T,2,0,"span",6),e.TgZ(7,"div",7)(8,"p"),e._uU(9),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.qZA()()()}if(2&a){const n=e.oxw();e.Q6J("ngClass",e.WLB(7,F,!n.loading,n.file.uploading)),e.xp6(4),e.Q6J("ngClass",e.VKq(10,x,!n.loading))("src",n.file.imageSrc,e.LSH),e.xp6(1),e.Q6J("ngIf",n.loading||n.file.uploading),e.xp6(1),e.Q6J("ngIf",n.file.uploaded),e.xp6(3),e.Oqu(n.file.type),e.xp6(2),e.Oqu(n.bytes)}}class f{constructor(t){this.utilsService=t,this.file=void 0,this.onRemoved=new e.vpe,this.loading=!0,this.bytes=""}ngOnInit(){!this.file||(this.bytes=this.utilsService.convertBytesToMegaBytes(this.file.size))}removed(){!this.file||this.onRemoved.emit(this.file.id)}static#e=this.\u0275fac=function(n){return new(n||f)(e.Y36(d))};static#n=this.\u0275cmp=e.Xpm({type:f,selectors:[["app-file-upload-token"]],inputs:{file:"file"},outputs:{onRemoved:"onRemoved"},decls:1,vars:1,consts:[["class","file-upload__container",3,"ngClass",4,"ngIf"],[1,"file-upload__container",3,"ngClass"],[1,"file-upload__information-container","file-upload__information-container-top"],[3,"click"],["loading","eager",1,"file-upload__thumbnail",3,"ngClass","src","load"],["class","file-upload__loading-spinner",4,"ngIf"],["class","material-symbols-outlined",4,"ngIf"],[1,"file-upload__information-container","file-upload__information-container-bottom"],[1,"file-upload__loading-spinner"],[1,"material-symbols-outlined"]],template:function(n,o){1&n&&e.YNc(0,Z,12,12,"div",0),2&n&&e.Q6J("ngIf",o.file)},dependencies:[s.mk,s.O5,y.g],styles:['.file-upload__container[_ngcontent-%COMP%]{width:100%;min-width:60px;height:160px;display:flex;align-items:center;justify-content:center;flex-direction:column;background:#c8c8c8;border-radius:3px;overflow:hidden;position:relative}.file-upload__container.show[_ngcontent-%COMP%]{filter:drop-shadow(0px 3px 3px grey)}.file-upload__container.uploading[_ngcontent-%COMP%]{opacity:.5}.file-upload__container[_ngcontent-%COMP%]:hover   .file-upload__information-container[_ngcontent-%COMP%], .file-upload__container[_ngcontent-%COMP%]:active   .file-upload__information-container[_ngcontent-%COMP%]{opacity:1;pointer-events:all}.file-upload__container[_ngcontent-%COMP%]   .file-upload__thumbnail[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity .8s linear}.file-upload__container[_ngcontent-%COMP%]   .file-upload__thumbnail.show[_ngcontent-%COMP%]{opacity:1}.file-upload__container[_ngcontent-%COMP%]   .file-upload__loading-spinner[_ngcontent-%COMP%]{position:absolute;filter:none}.file-upload__container[_ngcontent-%COMP%]   .file-upload__information-container[_ngcontent-%COMP%]{width:100%;position:absolute;opacity:0;transition:opacity .3s linear;pointer-events:none}.file-upload__container[_ngcontent-%COMP%]   .file-upload__information-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:100%;text-align:center;color:#fff;margin:0;padding:0}.file-upload__container[_ngcontent-%COMP%]   .file-upload__information-container-bottom[_ngcontent-%COMP%]{bottom:0;background:rgb(1,0,22);background:linear-gradient(0deg,rgb(1,0,0) 37%,rgba(1,0,0,.5102415966) 81%,rgba(0,0,0,0) 100%)}.file-upload__container[_ngcontent-%COMP%]   .file-upload__information-container-bottom[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{font-size:.6rem}.file-upload__container[_ngcontent-%COMP%]   .file-upload__information-container-top[_ngcontent-%COMP%]{top:0;background:rgb(1,0,22);background:linear-gradient(180deg,rgb(1,0,0) 37%,rgba(1,0,0,.5102415966) 81%,rgba(0,0,0,0) 100%)}.file-upload__container[_ngcontent-%COMP%]   .file-upload__information-container-top[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:right;padding-right:.5rem}.file-upload__container[_ngcontent-%COMP%]   .file-upload__information-container-top[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:hover{cursor:pointer}.material-symbols-outlined[_ngcontent-%COMP%]{position:absolute;color:#fff;font-size:4rem;font-variation-settings:"FILL" 1,"wght" 700,"GRAD" 0,"opsz" 48}']})}function w(a,t){if(1&a){const n=e.EpF();e.TgZ(0,"app-button",7),e.NdJ("submit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.uploadFiles())}),e.qZA()}if(2&a){const n=e.oxw();e.Q6J("label",n.uploadString)("disabled",n.uploading)}}function D(a,t){if(1&a){const n=e.EpF();e.TgZ(0,"div",8)(1,"app-button",9),e.NdJ("submit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.reset())}),e.qZA(),e.TgZ(2,"app-button",9),e.NdJ("submit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.navigateToAdminMenu())}),e.qZA()()}2&a&&(e.xp6(1),e.Q6J("label","Upload More"),e.xp6(1),e.Q6J("label","Admin Menu"))}function k(a,t){if(1&a){const n=e.EpF();e.TgZ(0,"app-file-upload-token",10),e.NdJ("onRemoved",function(i){e.CHM(n);const l=e.oxw();return e.KtG(l.removeToken(i))}),e.qZA()}2&a&&e.Q6J("file",t.$implicit)}const A=function(a){return{disable:a}};class _{constructor(t,n,o){this.httpClient=t,this.authorisationService=n,this.router=o,this.filesUploaded=[],this.dropZoneMessage="",this.uploadString="Upload",this.success=!1,this.uploading=!1,this.dropZoneDefaultMessage="Drag your files here, or click here to upload"}ngOnInit(){this.dropZoneMessage=this.dropZoneDefaultMessage}addFileForUpload(t){var n=this;const o=t.target.files||t.dataTransfer.files;Object.keys(o).forEach(function(){var i=(0,C.Z)(function*(l){o[l].imageSrc=yield n.imageFileToBase64(o[l]),o[l].id=(0,v.Z)(),n.filesUploaded.push(o[l]),n.uploadString=`Upload ${n.filesUploaded.length} image${n.filesUploaded.length>1?"s":""}`});return function(l){return i.apply(this,arguments)}}())}uploadFiles(){var t=this;return(0,C.Z)(function*(){const n=yield t.authorisationService.getBearerToken();t.uploading=!0,t.dropZoneMessage="Uploading...",t.filesUploaded.forEach((o,i)=>{o.uploading=!0;const l=new FormData;l.append("file",o,o.name),t.httpClient.post("api/images",l,{headers:new M.WM({Authorization:n})}).subscribe({next:()=>{o.uploading=!1,o.uploaded=!0,i===t.filesUploaded.length-1&&(t.success=!0,t.dropZoneMessage=t.setSuccessMessage(!1))},error:()=>{t.dropZoneMessage=t.setSuccessMessage(!0)}})})})()}imageFileToBase64(t){return(0,C.Z)(function*(){return new Promise((n,o)=>{var i=new FileReader;i.readAsDataURL(t),i.onload=l=>{n(i.result)}})})()}reset(){this.dropZoneMessage=this.dropZoneDefaultMessage,this.success=!1,this.filesUploaded=[],this.uploading=!1}navigateToAdminMenu(){this.router.navigate(["/admin-dashboard"])}setSuccessMessage(t){return t?"There was an issue with one or more uploads. Please try again later":`${this.filesUploaded.length?this.filesUploaded.length:"0"} file${1!=this.filesUploaded.length?"s":""} successfully uploaded.`}removeToken(t){this.filesUploaded=this.filesUploaded.filter(n=>n.id!==t)}static#e=this.\u0275fac=function(n){return new(n||_)(e.Y36(M.eN),e.Y36(O.g),e.Y36(p.F0))};static#n=this.\u0275cmp=e.Xpm({type:_,selectors:[["app-file-upload"]],decls:8,vars:7,consts:[["appDragDropFileUpload","",1,"file-upload__drop-zone",3,"ngClass","fileDropped"],["for","upload-input"],["id","upload-input","type","file","multiple","",1,"file-upload__file-input",3,"change"],[3,"label","disabled","submit",4,"ngIf"],["class","file-upload__success-button-wrapper",4,"ngIf"],[1,"file-upload__token-wrapper"],[3,"file","onRemoved",4,"ngFor","ngForOf"],[3,"label","disabled","submit"],[1,"file-upload__success-button-wrapper"],[3,"label","submit"],[3,"file","onRemoved"]],template:function(n,o){1&n&&(e.TgZ(0,"div",0),e.NdJ("fileDropped",function(l){return o.uploading?"":o.addFileForUpload(l)}),e.TgZ(1,"label",1),e._uU(2),e.qZA(),e.TgZ(3,"input",2),e.NdJ("change",function(l){return o.addFileForUpload(l)}),e.qZA()(),e.YNc(4,w,1,2,"app-button",3),e.YNc(5,D,3,2,"div",4),e.TgZ(6,"div",5),e.YNc(7,k,1,1,"app-file-upload-token",6),e.qZA()),2&n&&(e.Q6J("ngClass",e.VKq(5,A,o.uploading)),e.xp6(2),e.Oqu(o.dropZoneMessage),e.xp6(2),e.Q6J("ngIf",o.filesUploaded.length>0&&!o.success),e.xp6(1),e.Q6J("ngIf",o.success),e.xp6(2),e.Q6J("ngForOf",o.filesUploaded))},dependencies:[s.mk,s.sg,s.O5,P.r,u,f],styles:["[_nghost-%COMP%]{display:block}.file-upload__drop-zone[_ngcontent-%COMP%]{width:100%;height:150px;border:1px solid #c8c8c8;border-radius:3px;display:flex;align-items:center;justify-content:center}.file-upload__drop-zone.disable[_ngcontent-%COMP%]{background:#ececec!important}.file-upload__drop-zone[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{text-align:center;color:gray}.file-upload__drop-zone[_ngcontent-%COMP%]   .file-upload__file-input[_ngcontent-%COMP%]{opacity:0;z-index:-1;position:absolute}.file-upload__success-message[_ngcontent-%COMP%]{color:green;text-align:center;margin-bottom:0}.file-upload__success-button-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.file-upload__success-button-wrapper[_ngcontent-%COMP%]   app-button[_ngcontent-%COMP%]{width:48%}.file-upload__token-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center}.file-upload__token-wrapper[_ngcontent-%COMP%]   app-file-upload-token[_ngcontent-%COMP%]{margin:.5rem}"]})}var J=r(8897);class g{static#e=this.\u0275fac=function(n){return new(n||g)};static#n=this.\u0275cmp=e.Xpm({type:g,selectors:[["app-image-manager"]],decls:4,vars:0,consts:[[1,"image-manager__container"]],template:function(n,o){1&n&&(e.TgZ(0,"div",0)(1,"app-page-title"),e._uU(2,"Image Manager"),e.qZA(),e._UZ(3,"app-file-upload"),e.qZA())},dependencies:[_,J.T],styles:[".image-manager__container[_ngcontent-%COMP%]{padding:0 1rem 1rem;display:flex;flex-direction:column;height:100%;align-items:center;padding:1rem}.image-manager__container[_ngcontent-%COMP%]   app-page-title[_ngcontent-%COMP%]{width:100%}.image-manager__container[_ngcontent-%COMP%]   app-file-upload[_ngcontent-%COMP%]{width:90%;margin-top:1rem}"]})}const B=[{path:"",component:g}];class m{static#e=this.\u0275fac=function(n){return new(n||m)};static#n=this.\u0275mod=e.oAB({type:m});static#t=this.\u0275inj=e.cJS({imports:[p.Bz.forChild(B),p.Bz]})}var I=r(9952),z=r(2873);class h{static#e=this.\u0275fac=function(n){return new(n||h)};static#n=this.\u0275mod=e.oAB({type:h});static#t=this.\u0275inj=e.cJS({imports:[s.ez,m,I.O,z.p]})}},3522:(b,c,r)=>{r.d(c,{z:()=>e});var s=r(6895),p=r(8256);class e{static#e=this.\u0275fac=function(v){return new(v||e)};static#n=this.\u0275mod=p.oAB({type:e});static#t=this.\u0275inj=p.cJS({imports:[s.ez]})}}}]);